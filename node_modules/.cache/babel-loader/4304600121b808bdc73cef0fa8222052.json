{"ast":null,"code":"import _regeneratorRuntime from \"/home/kpost/Desktop/Political_UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/kpost/Desktop/Political_UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/kpost/Desktop/Political_UI/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/kpost/Desktop/Political_UI/src/views/components/EmployeeData/EmployeeUpload.jsx\";\n\nimport { ExportCSV } from \"../BulkUpload/ExportCSV.jsx\";\nimport { CCol, CInput, CLabel, CRow } from \"@coreui/react\";\nimport React, { useState, useEffect } from \"react\";\nimport Select from \"react-select\";\nimport * as XLSX from \"xlsx\";\nimport readXlsxFile from \"read-excel-file\";\nimport { getAllDepartment, getAllRole, getAreaSchema, getDesignation, getOfficeLocation, getOfficeType, RoleUploadData } from \"../../../services/ApiService\";\nimport { toast } from \"react-toastify\";\n\nvar EmployeeUpload = function EmployeeUpload() {\n  var reader = new FileReader();\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      files = _useState2[0],\n      setFiles = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      fileName = _useState4[0],\n      setFileName = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      customers = _useState6[0],\n      setCustomers = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      excelData = _useState8[0],\n      setExcelData = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      officeType = _useState10[0],\n      setOfficeType = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      officeLocation = _useState12[0],\n      setOfficeLocation = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      department = _useState14[0],\n      setDepartment = _useState14[1];\n\n  var _useState15 = useState([]),\n      _useState16 = _slicedToArray(_useState15, 2),\n      designation = _useState16[0],\n      setDesignation = _useState16[1];\n\n  var _useState17 = useState([]),\n      _useState18 = _slicedToArray(_useState17, 2),\n      templateData = _useState18[0],\n      setTemplateData = _useState18[1];\n\n  var _useState19 = useState([]),\n      _useState20 = _slicedToArray(_useState19, 2),\n      roles = _useState20[0],\n      setRoles = _useState20[1];\n\n  var _useState21 = useState([]),\n      _useState22 = _slicedToArray(_useState21, 2),\n      area = _useState22[0],\n      setArea = _useState22[1];\n\n  var capitalize = function capitalize(val) {\n    var string = val;\n    return \"\".concat(string[0].toUpperCase()).concat(string.slice(1));\n  };\n\n  var lowerCaseLetters = function lowerCaseLetters(val) {\n    var string = val;\n    return \"\".concat(string.toLowerCase());\n  };\n\n  var upperCaseLetter = function upperCaseLetter(val) {\n    var string = val;\n    return \"\".concat(string.toUpperCase());\n  };\n\n  useEffect(function () {\n    getAllOfficeTypes();\n  }, []);\n\n  var getAllOfficeTypes = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var responseR, response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return getAllRole(\"\");\n\n            case 3:\n              responseR = _context.sent;\n\n              if (responseR) {\n                if (responseR.data) {\n                  setRoles(responseR.data);\n                }\n              }\n\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 10:\n              _context.prev = 10;\n              _context.next = 13;\n              return getAreaSchema();\n\n            case 13:\n              response = _context.sent;\n\n              if (response) {\n                if (response.Area) {\n                  setArea(response.Area);\n                }\n              }\n\n              _context.next = 20;\n              break;\n\n            case 17:\n              _context.prev = 17;\n              _context.t1 = _context[\"catch\"](10);\n              console.log(_context.t1);\n\n            case 20:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7], [10, 17]]);\n    }));\n\n    return function getAllOfficeTypes() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (officeType.length > 0 && officeLocation.length > 0 && department.length > 0 && designation.length > 0) {\n      setOfficeTypeDatas();\n    }\n  }, [officeType, officeLocation, department, designation]);\n\n  var setOfficeTypeDatas = function setOfficeTypeDatas() {\n    var data = [[\"S_NO\", \"Office_Type\", \"Office_Code\", \"\", \"Office_Id\", \"\", \"S_NO\", \"Country_Name\", \"State_Name\", \"City_Name\", \"Area_Name\", \"Pincode\", \"Address_1\", \"Address_2\", \"\", \"Office_Location_Id\", \"\", \"S_NO\", \"Department_Name\", \"Department_Code\", \"Department_Abbreviation\", \"\", \"S_NO\", \"Designation_Name\", \"Designation_Code\", \"Designation_Abbreviation\", \"\"], []];\n    var length = 0;\n    length = officeType.length;\n    length = length < officeLocation.length ? officeLocation.length : length;\n    length = length < department.length ? department.length : length;\n    length = length < designation.length ? designation.length : length;\n    console.log(length, \"length\");\n\n    for (var index = 0; index < length; index++) {\n      data.push([officeType[index] ? index + 1 : \"\", officeType[index] ? officeType[index].officeType : \"\", officeType[index] ? officeType[index].code : \"\", \"\", officeType[index] ? officeType[index]._id : \"\", \"\", officeLocation[index] ? index + 1 : \"\", officeLocation[index] ? officeLocation[index].country.countryName : \"\", officeLocation[index] ? officeLocation[index].state.stateName : \"\", officeLocation[index] ? officeLocation[index].city.cityName : \"\", officeLocation[index] ? officeLocation[index].area.areaName : \"\", officeLocation[index] ? officeLocation[index].area.pincode : \"\", officeLocation[index] ? officeLocation[index].address1 : \"\", officeLocation[index] ? officeLocation[index].address2 : \"\", \"\", officeLocation[index] ? officeLocation[index]._id : \"\", \"\", department[index] ? index + 1 : \"\", department[index] ? department[index].name : \"\", department[index] ? department[index].code : \"\", department[index] ? department[index].abbreviation : \"\", \"\", designation[index] ? index + 1 : \"\", designation[index] ? designation[index].name : \"\", designation[index] ? designation[index].code : \"\", designation[index] ? designation[index].abbreviation : \"\"]);\n    }\n\n    setTemplateData(data);\n  };\n\n  useEffect(function () {\n    var f = files;\n\n    if (f.name) {\n      readXlsxFile(f).then(function (rows) {\n        var keys = rows[1];\n        rows.shift();\n        rows.shift();\n\n        if (rows.length > 0) {\n          var datas = [];\n          var data = {};\n          rows.map(function (x, j) {\n            x.map(function (y, i) {\n              data[keys[i]] = y;\n            });\n            data.sNo = j + 1;\n            datas.push(data);\n          });\n          console.log(datas);\n          setExcelData(datas);\n        }\n      });\n    }\n  }, [files]);\n  useEffect(function () {\n    var custs = [[\"Office_Type\", \"Office_Type_Id\", \"Office_Location_Area\", \"Office_Location_Pincode\", \"Office_Location_Id\", \"Department_Name\", \"Department_Code\", \"Department_Abbreviation\", \"Designation_Name\", \"Designation_Code\", \"Designation_Abbreviation\", \"Role_Name\", \"Role_Code\", \"Role_Abbreviation\"], []];\n    setCustomers(custs);\n    setFileName(\"EmployeeData\");\n  }, []);\n  useEffect(function () {\n    if (excelData.length > 0) {\n      var bulkUpload = /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n          var response;\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.prev = 0;\n                  _context2.next = 3;\n                  return RoleUploadData(excelData);\n\n                case 3:\n                  response = _context2.sent;\n\n                  if (response) {\n                    if (response.data) {\n                      toast.success(\"Role copy was posted successfully\");\n                    }\n                  }\n\n                  _context2.next = 10;\n                  break;\n\n                case 7:\n                  _context2.prev = 7;\n                  _context2.t0 = _context2[\"catch\"](0);\n                  console.log(_context2.t0);\n\n                case 10:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2, null, [[0, 7]]);\n        }));\n\n        return function bulkUpload() {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n\n      bulkUpload();\n    }\n  }, [excelData]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"OfficeLocationUpload\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(CRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CCol, {\n    className: \"role-heading-6\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 9\n    }\n  }, \"Party Member Bulk Upload\")), /*#__PURE__*/React.createElement(CRow, {\n    style: {\n      marginTop: \"40px\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CCol, {\n    md: \"6\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CCol, {\n    md: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ExportCSV, {\n    csvData: [customers, templateData],\n    fileName: fileName,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 15\n    }\n  })))), /*#__PURE__*/React.createElement(CCol, {\n    md: \"6\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CRow, {\n    onClick: function onClick() {\n      document.getElementById(\"uploadRoleTemplate\").click();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CCol, {\n    md: 1,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    style: {\n      fontSize: \"20px\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    class: \"fas fa-upload\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(CCol, {\n    md: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CLabel, {\n    style: {\n      position: \"relative\",\n      right: \"25px\",\n      top: \"5px\"\n    },\n    className: \"form-labels-6\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 15\n    }\n  }, \"Upload Template\"), /*#__PURE__*/React.createElement(CInput, {\n    id: \"uploadRoleTemplate\",\n    style: {\n      display: \"none\"\n    },\n    type: \"file\",\n    onChange: function onChange(e) {\n      setFiles(e.target.files[0]);\n    },\n    accept: \".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 15\n    }\n  }))))));\n};\n\nexport default EmployeeUpload;","map":{"version":3,"sources":["/home/kpost/Desktop/Political_UI/src/views/components/EmployeeData/EmployeeUpload.jsx"],"names":["ExportCSV","CCol","CInput","CLabel","CRow","React","useState","useEffect","Select","XLSX","readXlsxFile","getAllDepartment","getAllRole","getAreaSchema","getDesignation","getOfficeLocation","getOfficeType","RoleUploadData","toast","EmployeeUpload","reader","FileReader","files","setFiles","fileName","setFileName","customers","setCustomers","excelData","setExcelData","officeType","setOfficeType","officeLocation","setOfficeLocation","department","setDepartment","designation","setDesignation","templateData","setTemplateData","roles","setRoles","area","setArea","capitalize","val","string","toUpperCase","slice","lowerCaseLetters","toLowerCase","upperCaseLetter","getAllOfficeTypes","responseR","data","console","log","response","Area","length","setOfficeTypeDatas","index","push","code","_id","country","countryName","state","stateName","city","cityName","areaName","pincode","address1","address2","name","abbreviation","f","then","rows","keys","shift","datas","map","x","j","y","i","sNo","custs","bulkUpload","success","marginTop","document","getElementById","click","fontSize","position","right","top","display","e","target"],"mappings":";;;;;;;AAAA,SAASA,SAAT,QAA0B,6BAA1B;AACA,SAASC,IAAT,EAAeC,MAAf,EAAuBC,MAAvB,EAA+BC,IAA/B,QAA2C,eAA3C;AACA,OAAOC,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,MAAP,MAAmB,cAAnB;AACA,OAAO,KAAKC,IAAZ,MAAsB,MAAtB;AACA,OAAOC,YAAP,MAAyB,iBAAzB;AACA,SACEC,gBADF,EAEEC,UAFF,EAGEC,aAHF,EAIEC,cAJF,EAKEC,iBALF,EAMEC,aANF,EAOEC,cAPF,QAQO,8BARP;AASA,SAASC,KAAT,QAAsB,gBAAtB;;AAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,GAAM;AAC3B,MAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;;AAD2B,kBAEDf,QAAQ,CAAC,EAAD,CAFP;AAAA;AAAA,MAEpBgB,KAFoB;AAAA,MAEbC,QAFa;;AAAA,mBAGKjB,QAAQ,CAAC,EAAD,CAHb;AAAA;AAAA,MAGpBkB,QAHoB;AAAA,MAGVC,WAHU;;AAAA,mBAIOnB,QAAQ,CAAC,EAAD,CAJf;AAAA;AAAA,MAIpBoB,SAJoB;AAAA,MAITC,YAJS;;AAAA,mBAKOrB,QAAQ,CAAC,EAAD,CALf;AAAA;AAAA,MAKpBsB,SALoB;AAAA,MAKTC,YALS;;AAAA,mBAMSvB,QAAQ,CAAC,EAAD,CANjB;AAAA;AAAA,MAMpBwB,UANoB;AAAA,MAMRC,aANQ;;AAAA,oBAOiBzB,QAAQ,CAAC,EAAD,CAPzB;AAAA;AAAA,MAOpB0B,cAPoB;AAAA,MAOJC,iBAPI;;AAAA,oBAQS3B,QAAQ,CAAC,EAAD,CARjB;AAAA;AAAA,MAQpB4B,UARoB;AAAA,MAQRC,aARQ;;AAAA,oBASW7B,QAAQ,CAAC,EAAD,CATnB;AAAA;AAAA,MASpB8B,WAToB;AAAA,MASPC,cATO;;AAAA,oBAUa/B,QAAQ,CAAC,EAAD,CAVrB;AAAA;AAAA,MAUpBgC,YAVoB;AAAA,MAUNC,eAVM;;AAAA,oBAWFjC,QAAQ,CAAC,EAAD,CAXN;AAAA;AAAA,MAWpBkC,KAXoB;AAAA,MAWdC,QAXc;;AAAA,oBAYJnC,QAAQ,CAAC,EAAD,CAZJ;AAAA;AAAA,MAYpBoC,IAZoB;AAAA,MAYfC,OAZe;;AAe3B,MAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,GAAD,EAAS;AAC1B,QAAIC,MAAM,GAAGD,GAAb;AACA,qBAAUC,MAAM,CAAC,CAAD,CAAN,CAAUC,WAAV,EAAV,SAAoCD,MAAM,CAACE,KAAP,CAAa,CAAb,CAApC;AACD,GAHD;;AAKA,MAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACJ,GAAD,EAAS;AAChC,QAAIC,MAAM,GAAGD,GAAb;AACA,qBAAUC,MAAM,CAACI,WAAP,EAAV;AACD,GAHD;;AAKA,MAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACN,GAAD,EAAS;AAC/B,QAAIC,MAAM,GAAGD,GAAb;AACA,qBAAUC,MAAM,CAACC,WAAP,EAAV;AACD,GAHD;;AAKAxC,EAAAA,SAAS,CAAC,YAAM;AACd6C,IAAAA,iBAAiB;AAClB,GAFQ,EAEN,EAFM,CAAT;;AAIA,MAAMA,iBAAiB;AAAA,wEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAEExC,UAAU,CAAC,EAAD,CAFZ;;AAAA;AAEhByC,cAAAA,SAFgB;;AAGtB,kBAAGA,SAAH,EAAa;AACX,oBAAGA,SAAS,CAACC,IAAb,EAAkB;AAChBb,kBAAAA,QAAQ,CAACY,SAAS,CAACC,IAAX,CAAR;AACD;AACF;;AAPqB;AAAA;;AAAA;AAAA;AAAA;AAUtBC,cAAAA,OAAO,CAACC,GAAR;;AAVsB;AAAA;AAAA;AAAA,qBAaC3C,aAAa,EAbd;;AAAA;AAahB4C,cAAAA,QAbgB;;AActB,kBAAIA,QAAJ,EAAc;AACZ,oBAAIA,QAAQ,CAACC,IAAb,EAAmB;AACjBf,kBAAAA,OAAO,CAACc,QAAQ,CAACC,IAAV,CAAP;AACD;AACF;;AAlBqB;AAAA;;AAAA;AAAA;AAAA;AAoBtBH,cAAAA,OAAO,CAACC,GAAR;;AApBsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAjBJ,iBAAiB;AAAA;AAAA;AAAA,KAAvB;;AAwBA7C,EAAAA,SAAS,CAAC,YAAM;AACd,QACEuB,UAAU,CAAC6B,MAAX,GAAoB,CAApB,IACA3B,cAAc,CAAC2B,MAAf,GAAwB,CADxB,IAEAzB,UAAU,CAACyB,MAAX,GAAoB,CAFpB,IAGAvB,WAAW,CAACuB,MAAZ,GAAqB,CAJvB,EAKE;AACAC,MAAAA,kBAAkB;AACnB;AACF,GATQ,EASN,CAAC9B,UAAD,EAAaE,cAAb,EAA6BE,UAA7B,EAAyCE,WAAzC,CATM,CAAT;;AAWA,MAAMwB,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;AAC/B,QAAIN,IAAI,GAAG,CACT,CACE,MADF,EAEE,aAFF,EAGE,aAHF,EAIE,EAJF,EAKE,WALF,EAME,EANF,EAOE,MAPF,EAQE,cARF,EASE,YATF,EAUE,WAVF,EAWE,WAXF,EAYE,SAZF,EAaE,WAbF,EAcE,WAdF,EAeE,EAfF,EAgBE,oBAhBF,EAiBE,EAjBF,EAkBE,MAlBF,EAmBE,iBAnBF,EAoBE,iBApBF,EAqBE,yBArBF,EAsBE,EAtBF,EAuBE,MAvBF,EAwBE,kBAxBF,EAyBE,kBAzBF,EA0BE,0BA1BF,EA2BE,EA3BF,CADS,EA8BT,EA9BS,CAAX;AAiCA,QAAIK,MAAM,GAAG,CAAb;AACAA,IAAAA,MAAM,GAAG7B,UAAU,CAAC6B,MAApB;AACAA,IAAAA,MAAM,GAAGA,MAAM,GAAG3B,cAAc,CAAC2B,MAAxB,GAAiC3B,cAAc,CAAC2B,MAAhD,GAAyDA,MAAlE;AACAA,IAAAA,MAAM,GAAGA,MAAM,GAAGzB,UAAU,CAACyB,MAApB,GAA6BzB,UAAU,CAACyB,MAAxC,GAAiDA,MAA1D;AACAA,IAAAA,MAAM,GAAGA,MAAM,GAAGvB,WAAW,CAACuB,MAArB,GAA8BvB,WAAW,CAACuB,MAA1C,GAAmDA,MAA5D;AAEAJ,IAAAA,OAAO,CAACC,GAAR,CAAYG,MAAZ,EAAoB,QAApB;;AAEA,SAAK,IAAIE,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGF,MAA5B,EAAoCE,KAAK,EAAzC,EAA6C;AAC3CP,MAAAA,IAAI,CAACQ,IAAL,CAAU,CACRhC,UAAU,CAAC+B,KAAD,CAAV,GAAoBA,KAAK,GAAG,CAA5B,GAAgC,EADxB,EAER/B,UAAU,CAAC+B,KAAD,CAAV,GAAoB/B,UAAU,CAAC+B,KAAD,CAAV,CAAkB/B,UAAtC,GAAmD,EAF3C,EAGRA,UAAU,CAAC+B,KAAD,CAAV,GAAoB/B,UAAU,CAAC+B,KAAD,CAAV,CAAkBE,IAAtC,GAA6C,EAHrC,EAIR,EAJQ,EAKRjC,UAAU,CAAC+B,KAAD,CAAV,GAAoB/B,UAAU,CAAC+B,KAAD,CAAV,CAAkBG,GAAtC,GAA4C,EALpC,EAMR,EANQ,EAORhC,cAAc,CAAC6B,KAAD,CAAd,GAAwBA,KAAK,GAAG,CAAhC,GAAoC,EAP5B,EAQR7B,cAAc,CAAC6B,KAAD,CAAd,GAAwB7B,cAAc,CAAC6B,KAAD,CAAd,CAAsBI,OAAtB,CAA8BC,WAAtD,GAAoE,EAR5D,EASRlC,cAAc,CAAC6B,KAAD,CAAd,GAAwB7B,cAAc,CAAC6B,KAAD,CAAd,CAAsBM,KAAtB,CAA4BC,SAApD,GAAgE,EATxD,EAURpC,cAAc,CAAC6B,KAAD,CAAd,GAAwB7B,cAAc,CAAC6B,KAAD,CAAd,CAAsBQ,IAAtB,CAA2BC,QAAnD,GAA8D,EAVtD,EAWRtC,cAAc,CAAC6B,KAAD,CAAd,GAAwB7B,cAAc,CAAC6B,KAAD,CAAd,CAAsBnB,IAAtB,CAA2B6B,QAAnD,GAA8D,EAXtD,EAYRvC,cAAc,CAAC6B,KAAD,CAAd,GAAwB7B,cAAc,CAAC6B,KAAD,CAAd,CAAsBnB,IAAtB,CAA2B8B,OAAnD,GAA6D,EAZrD,EAaRxC,cAAc,CAAC6B,KAAD,CAAd,GAAwB7B,cAAc,CAAC6B,KAAD,CAAd,CAAsBY,QAA9C,GAAyD,EAbjD,EAcRzC,cAAc,CAAC6B,KAAD,CAAd,GAAwB7B,cAAc,CAAC6B,KAAD,CAAd,CAAsBa,QAA9C,GAAyD,EAdjD,EAeR,EAfQ,EAgBR1C,cAAc,CAAC6B,KAAD,CAAd,GAAwB7B,cAAc,CAAC6B,KAAD,CAAd,CAAsBG,GAA9C,GAAoD,EAhB5C,EAiBR,EAjBQ,EAkBR9B,UAAU,CAAC2B,KAAD,CAAV,GAAoBA,KAAK,GAAG,CAA5B,GAAgC,EAlBxB,EAmBR3B,UAAU,CAAC2B,KAAD,CAAV,GAAoB3B,UAAU,CAAC2B,KAAD,CAAV,CAAkBc,IAAtC,GAA6C,EAnBrC,EAoBRzC,UAAU,CAAC2B,KAAD,CAAV,GAAoB3B,UAAU,CAAC2B,KAAD,CAAV,CAAkBE,IAAtC,GAA6C,EApBrC,EAqBR7B,UAAU,CAAC2B,KAAD,CAAV,GAAoB3B,UAAU,CAAC2B,KAAD,CAAV,CAAkBe,YAAtC,GAAqD,EArB7C,EAsBR,EAtBQ,EAuBRxC,WAAW,CAACyB,KAAD,CAAX,GAAqBA,KAAK,GAAG,CAA7B,GAAiC,EAvBzB,EAwBRzB,WAAW,CAACyB,KAAD,CAAX,GAAqBzB,WAAW,CAACyB,KAAD,CAAX,CAAmBc,IAAxC,GAA+C,EAxBvC,EAyBRvC,WAAW,CAACyB,KAAD,CAAX,GAAqBzB,WAAW,CAACyB,KAAD,CAAX,CAAmBE,IAAxC,GAA+C,EAzBvC,EA0BR3B,WAAW,CAACyB,KAAD,CAAX,GAAqBzB,WAAW,CAACyB,KAAD,CAAX,CAAmBe,YAAxC,GAAuD,EA1B/C,CAAV;AA4BD;;AAEDrC,IAAAA,eAAe,CAACe,IAAD,CAAf;AACD,GA1ED;;AA4EA/C,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIsE,CAAC,GAAGvD,KAAR;;AACA,QAAIuD,CAAC,CAACF,IAAN,EAAY;AACVjE,MAAAA,YAAY,CAACmE,CAAD,CAAZ,CAAgBC,IAAhB,CAAqB,UAACC,IAAD,EAAU;AAC7B,YAAIC,IAAI,GAAGD,IAAI,CAAC,CAAD,CAAf;AACAA,QAAAA,IAAI,CAACE,KAAL;AACAF,QAAAA,IAAI,CAACE,KAAL;;AACA,YAAIF,IAAI,CAACpB,MAAL,GAAc,CAAlB,EAAqB;AACnB,cAAIuB,KAAK,GAAG,EAAZ;AACA,cAAI5B,IAAI,GAAG,EAAX;AACAyB,UAAAA,IAAI,CAACI,GAAL,CAAS,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACjBD,YAAAA,CAAC,CAACD,GAAF,CAAM,UAACG,CAAD,EAAIC,CAAJ,EAAU;AACdjC,cAAAA,IAAI,CAAC0B,IAAI,CAACO,CAAD,CAAL,CAAJ,GAAgBD,CAAhB;AACD,aAFD;AAGAhC,YAAAA,IAAI,CAACkC,GAAL,GAAWH,CAAC,GAAG,CAAf;AACAH,YAAAA,KAAK,CAACpB,IAAN,CAAWR,IAAX;AACD,WAND;AAOAC,UAAAA,OAAO,CAACC,GAAR,CAAY0B,KAAZ;AACArD,UAAAA,YAAY,CAACqD,KAAD,CAAZ;AACD;AACF,OAjBD;AAkBD;AACF,GAtBQ,EAsBN,CAAC5D,KAAD,CAtBM,CAAT;AAwBAf,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIkF,KAAK,GAAG,CACV,CACE,aADF,EAEE,gBAFF,EAGE,sBAHF,EAIE,yBAJF,EAKE,oBALF,EAME,iBANF,EAOE,iBAPF,EAQE,yBARF,EASE,kBATF,EAUE,kBAVF,EAWE,0BAXF,EAYE,WAZF,EAaE,WAbF,EAcE,mBAdF,CADU,EAiBV,EAjBU,CAAZ;AAmBA9D,IAAAA,YAAY,CAAC8D,KAAD,CAAZ;AACAhE,IAAAA,WAAW,CAAC,cAAD,CAAX;AACD,GAtBQ,EAsBN,EAtBM,CAAT;AAwBAlB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIqB,SAAS,CAAC+B,MAAV,GAAmB,CAAvB,EAA0B;AACxB,UAAM+B,UAAU;AAAA,6EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAEQzE,cAAc,CAACW,SAAD,CAFtB;;AAAA;AAET6B,kBAAAA,QAFS;;AAGf,sBAAIA,QAAJ,EAAc;AACZ,wBAAIA,QAAQ,CAACH,IAAb,EAAmB;AACjBpC,sBAAAA,KAAK,CAACyE,OAAN,CAAc,mCAAd;AACD;AACF;;AAPc;AAAA;;AAAA;AAAA;AAAA;AASfpC,kBAAAA,OAAO,CAACC,GAAR;;AATe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAH;;AAAA,wBAAVkC,UAAU;AAAA;AAAA;AAAA,SAAhB;;AAYAA,MAAAA,UAAU;AACX;AACF,GAhBQ,EAgBN,CAAC9D,SAAD,CAhBM,CAAT;AAkBA,sBACE;AAAK,IAAA,SAAS,EAAC,sBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,SAAS,EAAE,gBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCADF,CADF,eAIE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE;AAAEgE,MAAAA,SAAS,EAAE;AAAb,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAE,GAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAE,EAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AACE,IAAA,OAAO,EAAE,CAAClE,SAAD,EAAYY,YAAZ,CADX;AAEE,IAAA,QAAQ,EAAEd,QAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,CADF,CADF,eAWE,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAE,GAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AACE,IAAA,OAAO,EAAE,mBAAM;AACbqE,MAAAA,QAAQ,CAACC,cAAT,CAAwB,oBAAxB,EAA8CC,KAA9C;AACD,KAHH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKE,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAE,CAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAM,IAAA,KAAK,EAAE;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAG,IAAA,KAAK,EAAC,eAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,CALF,eAUE,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAE,CAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AACE,IAAA,KAAK,EAAE;AAAEC,MAAAA,QAAQ,EAAE,UAAZ;AAAwBC,MAAAA,KAAK,EAAE,MAA/B;AAAuCC,MAAAA,GAAG,EAAE;AAA5C,KADT;AAEE,IAAA,SAAS,EAAE,eAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,eAOE,oBAAC,MAAD;AACE,IAAA,EAAE,EAAE,oBADN;AAEE,IAAA,KAAK,EAAE;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAFT;AAGE,IAAA,IAAI,EAAE,MAHR;AAIE,IAAA,QAAQ,EAAE,kBAACC,CAAD,EAAO;AACf9E,MAAAA,QAAQ,CAAC8E,CAAC,CAACC,MAAF,CAAShF,KAAT,CAAe,CAAf,CAAD,CAAR;AACD,KANH;AAOE,IAAA,MAAM,EAAC,mGAPT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPF,CAVF,CADF,CAXF,CAJF,CADF;AAkDD,CArQD;;AAuQA,eAAeH,cAAf","sourcesContent":["import { ExportCSV } from \"../BulkUpload/ExportCSV.jsx\";\nimport { CCol, CInput, CLabel, CRow } from \"@coreui/react\";\nimport React, { useState, useEffect } from \"react\";\nimport Select from \"react-select\";\nimport * as XLSX from \"xlsx\";\nimport readXlsxFile from \"read-excel-file\";\nimport {\n  getAllDepartment,\n  getAllRole,\n  getAreaSchema,\n  getDesignation,\n  getOfficeLocation,\n  getOfficeType,\n  RoleUploadData,\n} from \"../../../services/ApiService\";\nimport { toast } from \"react-toastify\";\n\nconst EmployeeUpload = () => {\n  const reader = new FileReader();\n  const [files, setFiles] = useState({});\n  const [fileName, setFileName] = useState(\"\");\n  const [customers, setCustomers] = useState([]);\n  const [excelData, setExcelData] = useState([]);\n  const [officeType, setOfficeType] = useState([]);\n  const [officeLocation, setOfficeLocation] = useState([]);\n  const [department, setDepartment] = useState([]);\n  const [designation, setDesignation] = useState([]);\n  const [templateData, setTemplateData] = useState([]);\n  const [roles,setRoles] = useState([]);\n  const [area,setArea] = useState([]);\n  \n\n  const capitalize = (val) => {\n    var string = val;\n    return `${string[0].toUpperCase()}${string.slice(1)}`;\n  };\n\n  const lowerCaseLetters = (val) => {\n    var string = val;\n    return `${string.toLowerCase()}`;\n  };\n\n  const upperCaseLetter = (val) => {\n    var string = val;\n    return `${string.toUpperCase()}`;\n  };\n\n  useEffect(() => {\n    getAllOfficeTypes();\n  }, []);\n\n  const getAllOfficeTypes = async () => {\n    try{\n      const responseR = await getAllRole(\"\");\n      if(responseR){\n        if(responseR.data){\n          setRoles(responseR.data)\n        }\n      }\n    }\n    catch(e){\n      console.log(e);\n    }\n    try {\n      const response = await getAreaSchema();\n      if (response) {\n        if (response.Area) {\n          setArea(response.Area);\n        }\n      }\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  useEffect(() => {\n    if (\n      officeType.length > 0 &&\n      officeLocation.length > 0 &&\n      department.length > 0 &&\n      designation.length > 0\n    ) {\n      setOfficeTypeDatas();\n    }\n  }, [officeType, officeLocation, department, designation]);\n\n  const setOfficeTypeDatas = () => {\n    let data = [\n      [\n        \"S_NO\",\n        \"Office_Type\",\n        \"Office_Code\",\n        \"\",\n        \"Office_Id\",\n        \"\",\n        \"S_NO\",\n        \"Country_Name\",\n        \"State_Name\",\n        \"City_Name\",\n        \"Area_Name\",\n        \"Pincode\",\n        \"Address_1\",\n        \"Address_2\",\n        \"\",\n        \"Office_Location_Id\",\n        \"\",\n        \"S_NO\",\n        \"Department_Name\",\n        \"Department_Code\",\n        \"Department_Abbreviation\",\n        \"\",\n        \"S_NO\",\n        \"Designation_Name\",\n        \"Designation_Code\",\n        \"Designation_Abbreviation\",\n        \"\",\n      ],\n      [],\n    ];\n\n    let length = 0;\n    length = officeType.length;\n    length = length < officeLocation.length ? officeLocation.length : length;\n    length = length < department.length ? department.length : length;\n    length = length < designation.length ? designation.length : length;\n\n    console.log(length, \"length\");\n\n    for (let index = 0; index < length; index++) {\n      data.push([\n        officeType[index] ? index + 1 : \"\",\n        officeType[index] ? officeType[index].officeType : \"\",\n        officeType[index] ? officeType[index].code : \"\",\n        \"\",\n        officeType[index] ? officeType[index]._id : \"\",\n        \"\",\n        officeLocation[index] ? index + 1 : \"\",\n        officeLocation[index] ? officeLocation[index].country.countryName : \"\",\n        officeLocation[index] ? officeLocation[index].state.stateName : \"\",\n        officeLocation[index] ? officeLocation[index].city.cityName : \"\",\n        officeLocation[index] ? officeLocation[index].area.areaName : \"\",\n        officeLocation[index] ? officeLocation[index].area.pincode : \"\",\n        officeLocation[index] ? officeLocation[index].address1 : \"\",\n        officeLocation[index] ? officeLocation[index].address2 : \"\",\n        \"\",\n        officeLocation[index] ? officeLocation[index]._id : \"\",\n        \"\",\n        department[index] ? index + 1 : \"\",\n        department[index] ? department[index].name : \"\",\n        department[index] ? department[index].code : \"\",\n        department[index] ? department[index].abbreviation : \"\",\n        \"\",\n        designation[index] ? index + 1 : \"\",\n        designation[index] ? designation[index].name : \"\",\n        designation[index] ? designation[index].code : \"\",\n        designation[index] ? designation[index].abbreviation : \"\",\n      ]);\n    }\n\n    setTemplateData(data);\n  };\n\n  useEffect(() => {\n    var f = files;\n    if (f.name) {\n      readXlsxFile(f).then((rows) => {\n        let keys = rows[1];\n        rows.shift();\n        rows.shift();\n        if (rows.length > 0) {\n          let datas = [];\n          let data = {};\n          rows.map((x, j) => {\n            x.map((y, i) => {\n              data[keys[i]] = y;\n            });\n            data.sNo = j + 1;\n            datas.push(data);\n          });\n          console.log(datas);\n          setExcelData(datas);\n        }\n      });\n    }\n  }, [files]);\n\n  useEffect(() => {\n    let custs = [\n      [\n        \"Office_Type\",\n        \"Office_Type_Id\",\n        \"Office_Location_Area\",\n        \"Office_Location_Pincode\",\n        \"Office_Location_Id\",\n        \"Department_Name\",\n        \"Department_Code\",\n        \"Department_Abbreviation\",\n        \"Designation_Name\",\n        \"Designation_Code\",\n        \"Designation_Abbreviation\",\n        \"Role_Name\",\n        \"Role_Code\",\n        \"Role_Abbreviation\",\n      ],\n      [],\n    ];\n    setCustomers(custs);\n    setFileName(\"EmployeeData\");\n  }, []);\n\n  useEffect(() => {\n    if (excelData.length > 0) {\n      const bulkUpload = async () => {\n        try {\n          const response = await RoleUploadData(excelData);\n          if (response) {\n            if (response.data) {\n              toast.success(\"Role copy was posted successfully\");\n            }\n          }\n        } catch (e) {\n          console.log(e);\n        }\n      };\n      bulkUpload();\n    }\n  }, [excelData]);\n\n  return (\n    <div className=\"OfficeLocationUpload\">\n      <CRow>\n        <CCol className={\"role-heading-6\"}>Party Member Bulk Upload</CCol>\n      </CRow>\n      <CRow style={{ marginTop: \"40px\" }}>\n        <CCol md={\"6\"}>\n          <CRow>\n            <CCol md={12}>\n              <ExportCSV\n                csvData={[customers, templateData]}\n                fileName={fileName}\n              />\n            </CCol>\n          </CRow>\n        </CCol>\n        <CCol md={\"6\"}>\n          <CRow\n            onClick={() => {\n              document.getElementById(\"uploadRoleTemplate\").click();\n            }}\n          >\n            <CCol md={1}>\n              <span style={{ fontSize: \"20px\" }}>\n                <i class=\"fas fa-upload\"></i>\n              </span>\n            </CCol>\n            <CCol md={6}>\n              <CLabel\n                style={{ position: \"relative\", right: \"25px\", top: \"5px\" }}\n                className={\"form-labels-6\"}\n              >\n                Upload Template\n              </CLabel>\n              <CInput\n                id={\"uploadRoleTemplate\"}\n                style={{ display: \"none\" }}\n                type={\"file\"}\n                onChange={(e) => {\n                  setFiles(e.target.files[0]);\n                }}\n                accept=\".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\n              />\n            </CCol>\n          </CRow>\n        </CCol>\n      </CRow>\n      {/* application/vnd.openxmlformats-officedocument.spreadsheetml.sheet */}\n    </div>\n  );\n};\n\nexport default EmployeeUpload;"]},"metadata":{},"sourceType":"module"}